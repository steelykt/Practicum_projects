# Определение возраста покупателей

**Описание проекта:**

Сетевой супермаркет «Хлеб-Соль» внедряет систему компьютерного зрения для обработки фотографий покупателей. Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы:
- Анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
- Контролировать добросовестность кассиров при продаже алкоголя.

**Задача проекта:**

Постройте модель, которая по фотографии определит приблизительный возраст человека. В вашем распоряжении набор фотографий людей с указанием возраста.

**Инструкция по выполнению проекта:**

- *Проведите исследовательский анализ набора фотографий.*
- *Подготовьте данные к обучению.*
- *Обучите нейронную сеть и рассчитайте её качество.*

**Описание данных:**

Данные взяты с сайта ChaLearn Looking at People. Они находятся в папке `/datasets/faces/`.
В вашем распоряжении одна папка со всеми изображениями `(/final_files)` и CSV-файл `labels.csv` с двумя колонками: `file_name` и `real_age`.
Извлечь данные из папки вам поможет новый метод `ImageDataGenerator` `—flow_from_dataframe(dataframe, directory, ...)`.

**Общий вывод:**

Получили данные, провели исследовательский анализ набора фотографий, где 7591 фотографий с указанием возраста от 1 года до 100 лет. Построили график распределения возраста, где средний возраст составил 31 год. 
Напечатали на экране 15 фотографий и посмотрели. Фотографии плохого качества. 

Определили, что данных мало и плохого качества, поэтому не стоит ждать хороших результатов обучения модели.

<u>Подготовили данные:</u> 

Функции `load_train` и `load_test` загружают данные для обучения и тестирования соответственно.
Данные дополнены с помощью `ImageDataGenerator`, который включает такие методы, как переворот, вращение и смещение, чтобы повысить устойчивость модели к переобучению. Данные разделены на обучающую (75%) и валидационную (25%) выборки.
Функцией `create_model` создали модель с использованием `API Sequential` и самой известной архитектурой `ResNet50` в качестве основы.
Обучение использует среднюю абсолютную ошибку (MAE) в качестве функции потерь, что уместно для задач регрессии, таких как предсказание возраста.

<u>Результаты модели:</u>

На первых этапах обучения значения MAE были значительно высокими (например, 16.41 на первой эпохе),дальше наблюдается постепенное снижение MAE, достигнув 7.66 к 30-й эпохе. Это указывает на то, что модель успешно обучается и делает более точные предсказания по мере прохождения эпох.
MAE на валидационной выборке сначала также снижалось, что является хорошим признаком. Попеременное повышение и понижение MAE на валидации в некоторых эпохах (например, с 9.39 на 21-й по 8.38 на 23-й) может свидетельствовать о переобучении. Однако, окончательное значение MAE на валидации 7.66 свидетельствует о том, что модель, в целом, хорошо обобщается на тестовых данных.
Таким образом, свёрточная нейронная сеть показывает хорошие результаты, и есть возможность дальнейшего улучшения.

<u>Рекомендации:</u>
- Увеличить и улучшить набор данных (улучшить аугментацию)
- Лучше подобрать и настроить параметры модели (поменять архитектуру, добавив, заморозив слои и регуляризацию, поменять дропауты)
- Можно использовать несколько моделей, или другую более обученную модель