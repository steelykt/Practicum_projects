# Проект: "Телекоммуникации"

**Описание проекта:**

Оператор связи «ТелеДом» хочет бороться с оттоком клиентов. Для этого его сотрудники начнут предлагать промокоды и специальные условия всем, кто планирует отказаться от услуг связи. Чтобы заранее находить таких пользователей, «ТелеДому» нужна модель, которая будет предсказывать, разорвёт ли абонент договор. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и услугах.

Оператор предоставляет два основных типа услуг: 
- Стационарную телефонную связь. Телефон можно подключить к нескольким линиям одновременно.
- Интернет. Подключение может быть двух типов: через телефонную линию (DSL, от англ. digital subscriber line — «цифровая абонентская линия») или оптоволоконный кабель (Fiber optic).

Также доступны такие услуги:
- Интернет-безопасность: антивирус (DeviceProtection) и блокировка небезопасных сайтов (OnlineSecurity);
- Выделенная линия технической поддержки (TechSupport);
- Облачное хранилище файлов для резервного копирования данных (OnlineBackup);
- Стриминговое телевидение (StreamingTV) и каталог фильмов (StreamingMovies).

Клиенты могут платить за услуги каждый месяц или заключить договор на 1–2 года. Возможно оплатить счёт разными способами, а также получить электронный чек.

**Описание данных:**

Данные состоят из нескольких файлов, полученных из разных источников:

- `contract_new.csv` — информация о договоре;
- `personal_new.csv` — персональные данные клиента;
- `internet_new.csv` — информация об интернет-услугах;
- `phone_new.csv` — информация об услугах телефонии.

**Файл contract_new.csv**

- `customerID` — идентификатор абонента;
- `BeginDate` — дата начала действия договора;
- `EndDate` — дата окончания действия договора;
- `Type` — тип оплаты: раз в год-два или ежемесячно;
- `PaperlessBilling` — электронный расчётный лист;
- `PaymentMethod` — тип платежа;
- `MonthlyCharges` — расходы за месяц;
- `TotalCharges` — общие расходы абонента.

**Файл personal_new.csv**

- `customerID` — идентификатор пользователя;
- `gender` — пол;
- `SeniorCitizen` — является ли абонент пенсионером;
- `Partner` — есть ли у абонента супруг или супруга;
- `Dependents` — есть ли у абонента дети.

**Файл internet_new.csv**

- `customerID` — идентификатор пользователя;
- `InternetService` — тип подключения;
- `OnlineSecurity` — блокировка опасных сайтов;
- `OnlineBackup` — облачное хранилище файлов для резервного копирования данных;
- `DeviceProtection` — антивирус;
- `TechSupport` — выделенная линия технической поддержки;
- `StreamingTV` — стриминговое телевидение;
- `StreamingMovies` — каталог фильмов.

**Файл `phone_new.csv`**

- `customerID` — идентификатор пользователя;
- `MultipleLines` — подключение телефона к нескольким линиям одновременно.

Во всех файлах столбец customerID содержит код клиента. Информация о договорах актуальна на 1 февраля 2020 года.

**Цель работы:**

Обучить на этих данных модель для прогноза оттока клиентов.

**Вывод:** 

Загрузили данные, провели предварительный обзор данных, а это, пять таблиц, проверили их на пропуски, ошибки и аномалии. Затем соединили их в одну таблицу, исключили неполные, неинформативные данные. Провели исследовательский анализ, построили графики сравнения соотношений для ушедших и оставшихся клиентов, построили матрицу коррелиции, чтобы рассмотреть взаимосвязь между данными. А также создали новые признаки для лучшего обучения моделей. Разделили данные на тренировочную и тестовую выборки соотношением 1 к 4. Перекодировали категориальные признаки и обучили 3 модели: _Линейная модель_: `LogisticRegression`, _Модель градиентного бустинга_: `LGBMClassifier`, _Ансамблевая модель_: `RandomForestClassifier` для которых подобрали различные гиперпараметры, а методом `GridSearchCV` с помощью пайплайна и метрики оценки `roc_auc_score` выбрали лучшую модель. На тренировочных данных хорошие результаты, 82%, показала модель бустера Lightgbm, ее и использовали на тестовых данных.
Получили работающую модель для прогноза оттока клиентов с точностью в 84 %.

Судя по последним годам у компании вроде все хорошо, клиенты растут, отток минимальный.