# Проект: Линейные модели в машинном обучении

**Описание проекта:**

К нам обратился фермер, владелец молочного хозяйства «Вольный луг». Он хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ «ЭкоФерма».

Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а её надой был вкусным — строго по его критериям, ничуть не хуже. А продавцы и технологии так и норовят приукрасить своих коровок!

**Цель исследования:**

Разработать модель машинного обучения, которая поможет фермеру управлять рисками и принимать объективное решение о покупке. 
Нам нужно создать две прогнозные модели для отбора бурёнок в поголовье:
- Первая будет прогнозировать возможный удой коровы (целевой признак `'Удой'`);
- Вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак `'Вкус молока'`).

**Задача исследования:**

С помощью модели нужно отобрать коров по двум критериям:
- средний удой за год — не менее 6000 килограммов;
- молоко должно быть вкусным.

**Исходные данные:**

«ЭкоФерма» готова предоставить подробные данные о своих коровах. 

- `'ferma_main.csv'` - содержит данные о стаде фермера на текущий момент.
    - id — уникальный идентификатор коровы.
    - Удой, кг — масса молока, которую корова даёт в год (в килограммах).
    - ЭКЕ (Энергетическая кормовая единица) — показатель питательности корма коровы.
    - Сырой протеин, г — содержание сырого протеина в корме (в граммах).
    - СПО (Сахаро-протеиновое соотношение) — отношение сахара к протеину в корме коровы.
    - Порода — порода коровы.
    - Тип пастбища — ландшафт лугов, на которых паслась корова.
    - порода папы_быка — порода папы коровы.
    - Жирность,% — содержание жиров в молоке (в процентах).
    - Белок,% — содержание белков в молоке (в процентах).
    - Вкус молока — оценка вкуса по личным критериям фермера, бинарный признак (вкусно, не вкусно).
    - Возраст — возраст коровы, бинарный признак (менее_2_лет, более_2_лет).
- `'ferma_dad.csv'` - хранит имя папы каждой коровы в стаде фермера.
    - id — уникальный идентификатор коровы.
    - Имя Папы — имя папы коровы.
- `'cow_buy.csv'` - cодержание белков и жиров в молоке указано на момент продажи — когда «ЭкоФерма» давала коровам свой корм.
    - Порода — порода коровы.
    - Тип пастбища — ландшафт лугов, на которых паслась корова.
    - порода папы_быка — порода папы коровы.
    - Имя_папы — имя папы коровы.
    - Текущая_жирность,% — содержание жиров в молоке (в процентах).
    - Текущий_уровень_белок,% — содержание белков в молоке (в процентах).
    - Возраст — возраст коровы, бинарный признак (менее_2_лет, более_2_лет).

**Вывод:** Получив и изучив данные, провели их предобработку и привели в нужный формат для дальнейшего анализа. Построили графики и изучив их обнаружив аномалии избавились от них. Провели корреляционный анализ простроив диаграммы рассеяния, зависимости целевого признака - "Удоя" от других данных.

Для прогноза `Удой` обучили три модели линейной регрессии. На вход для построения первой модели была предоставлена таблица `'ferma_main'`. Эти данные были поделены на тренировочные, на которых модель обучалась и тестовые для итогового качества модели. Модель хорошо себя показывала в 82% случаев. Но изучив остатки и дисперсию данной модели, какие-то данные сильно влияли на нее, такую можедь использовать нельзя. Нужны были дополнительные исследования. Во второй моделе изменили и добавили данные, которые влияли на поведение нашей модели. Модель показала себя лучше, уже 84% и независимое распределение дисперсии. В третью модель добавили таблицу с именами пап `ferma_dad`, и обучили модель на этих данных, уже 86%. Добавляя новые данные, возможно улучшение качества модели.

Оценив качество каждой модели по трём метрикам: MSE(среднеквадратичная ошибка), MAE(средняя абсолютная ошибка), RMSE(корень среднеквадратичной ошибки) и проанализировав выбрали третью модель. Использовав ее вычислили предположительный Удой коров из таблицы `cow_buy` и добавили в таблицу. 

Для прогноза `Вкус молока` обучили модель логистической регрессии. Проанализировав и рассчитав метрики accuracy(доля верных ответов модели), recall(полнота), precision(точность). Получили прогноз, записав в таблицу.

Исходя из проделанного анализа, рекомендую купить 11 коров из списка, т.к. модели могут ошибаться. При изменения рациона как в таблице, т.е. увеличении ЭКЕ, СПО и протеина выбирать с высокими показателями удоя. А также высокими показателями жирности и белка, старше 2 лет. Желательно породы РефлешнСоверинг, папы Айдиал, тип пастбища Холмистое для вкусного молока. Не выбирать имя папы быка Геркулес, особенно породы Соверин. С осторожностью Соловчик.

Для линейной регрессии желательно независимые данные с минимальными отклонениями. Для логистической же наоборот важна зависимость, но только одних данных. Плюс добавление новых данных влияет на качество модели. После покупки также составить данные этих коров за несколько месяцев и затем включить их 